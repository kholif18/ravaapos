<div class="d-flex mb-3 gap-2 justify-content-between align-items-center">
  <h5 class="card-title mb-0 flex-grow-1">Categories</h5>
  <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalCreate">
    + Add Category
  </button>
</div>
<div class="card">
  <div class="card-body">
    <table class="table">
      <thead>
        <tr>
          <th>Nama <i class="bx bx-sort-alt-2"></i></th>
          <th>Jumlah Item</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody>
        <% categories.forEach(cat => { %>
          <tr>
            <td><%= cat.name %></td>
            <td>
              <span class="badge bg-info"><%= cat.items?.length || 0 %> Item</span>
            </td>
            <td>
              <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modalEdit"
                data-id="<%= cat.id %>" data-name="<%= cat.name %>" >
                <i class="bx bx-edit"></i>
              </button>

              <form action="/categories/<%= cat.id %>/delete" method="POST" style="display:inline">
                <button type="submit" class="btn btn-sm btn-outline-danger">
                  <i class="bx bx-trash"></i>
                </button>
              </form>
            </td>

          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>


<div class="modal fade" id="modalCreate" tabindex="-1">
  <div class="modal-dialog">
    <form class="modal-content" action="/categories" method="POST">
      <div class="modal-header">
        <h5 class="modal-title">Tambah Kategori</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="text" name="name" class="form-control" placeholder="Nama kategori" required>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary">Simpan</button>
      </div>
    </form>
  </div>
</div>


<div class="modal fade" id="modalEdit" tabindex="-1">
  <div class="modal-dialog">
    <form class="modal-content" method="POST" id="formEdit">
      <div class="modal-header">
        <h5 class="modal-title">Edit Kategori</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="text" name="name" id="editName" class="form-control" required>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary">Update</button>
      </div>
    </form>
  </div>
</div>


<script>
  const modalEdit = document.getElementById('modalEdit');
  modalEdit.addEventListener('show.bs.modal', function (event) {
    const button = event.relatedTarget;
    const id = button.getAttribute('data-id');
    const name = button.getAttribute('data-name');

    const form = document.getElementById('formEdit');
    const input = document.getElementById('editName');

    input.value = name;
    form.action = `/categories/${id}/update`;
  });
</script>
