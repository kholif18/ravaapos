<div id="purchasingWrapper">
  <table class="table table-hover">
    <thead>
      <tr>
        <th>No</th>
        <th>Tanggal</th>
        <th>Supplier</th>
        <th>Total</th>
        <th>Status</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody id="purchasingTbody">
      <% if (purchasings.length === 0) { %>
        <tr>
          <td colspan="6" class="text-center text-muted py-4">Tidak ada data purchasing ditemukan.</td>
        </tr>
      <% } else {
        const startNumber = (pagination.page - 1) * pagination.limit + 1;
        for (let i = 0; i < purchasings.length; i++) {
          const p = purchasings[i]; %>
          <tr>
            <td><%= startNumber + i %></td>
            <td><%= new Date(p.date).toLocaleDateString() %></td>
            <td><%= p.supplier?.name || '-' %></td>
            <td><%= p.total.toLocaleString() %></td>
            <td>
              <% if (p.status === 'completed') { %>
                <span class="badge bg-success">Completed</span>
              <% } else if (p.status === 'draft') { %>
                <span class="badge bg-warning">Draft</span>
              <% } else if (p.status === 'cancelled') { %>
                <span class="badge bg-danger">Cancelled</span>
              <% } %>
            </td>
            <td>
                <button class="btn btn-sm btn-info btn-view" data-id="<%= p.id %>">
                    <i class="bx bx-show"></i>
                </button>
                <% if (p.status === 'draft') { %>
                    <button class="btn btn-sm btn-success btn-complete" data-id="<%= p.id %>">
                    <i class="bx bx-check"></i> Complete
                    </button>
                    <button class="btn btn-sm btn-danger btn-cancel" data-id="<%= p.id %>">
                    <i class="bx bx-x"></i> Cancel
                    </button>
                <% } else if (p.status === 'completed') { %>
                    <button class="btn btn-sm btn-warning btn-return" data-id="<%= p.id %>">
                    <i class="bx bx-rotate-left"></i> Return
                    </button>
                <% } %>
                </td>
          </tr>
      <% } } %>
    </tbody>
  </table>

  <div id="purchasingPaginationWrapper">
    <%- include('../partials/pagination', { pagination }) %>
  </div>
</div>

<div class="modal fade" id="modalViewPurchasing" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Detail Purchasing</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="modalViewContent">
        <!-- Data AJAX akan masuk sini -->
      </div>
    </div>
  </div>
</div>
